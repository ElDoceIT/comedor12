<!DOCTYPE html>
<html xmlns:th="http://thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="shortcut icon" th:href="@{/images/El-Doce-TV-en-vivo-Online-1.png}" type="image/x-icon">

  <link th:href="@{/bootstrap/css/bootstrap.min.css}" rel="stylesheet">
  <link th:href="@{/bootstrap/css/jumbotron.css}" rel="stylesheet">
  <link th:href="@{/bootstrap/css/sticky-footer-navbar.css}" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.5.0/font/bootstrap-icons.min.css">
  <link rel="stylesheet" th:href="@{/css/style.css}">

  <title>Ingreso comida</title>
</head>
<body>
<header th:insert="fragments/menu :: menu-principal"></header>

<div class="container mt-5">
  <div class="card text-white bg-dark mb-3">
    <div class="card-header">
      <h4>Reservas del Día --> Total: <span th:text="${totalReservas}"></span>, Consumidas: <span th:text="${totalConsumidas}"></span></h4>
    </div>
    <div class="card-body">
      <div class="row">
        <!-- Tabla de resumen de tipos de comida -->
        <div class="col-md-6">
          <h5 class="text-white">Resumen por Tipo de Comida</h5>
          <ul class="list-group">
            <li class="list-group-item bg-secondary text-white" th:each="entry : ${sumaPorTipoComida}">
              <span th:text="${tipoComidaDescripcion[entry.key]}">Tipo de Comida</span>:
              <span th:text="${entry.value}">0</span>
            </li>
          </ul>
        </div>

        <!-- Tabla de resumen por lugar de consumo -->
        <div class="col-md-6">
          <h5 class="text-white">Resumen por Lugar de Consumo</h5>
          <ul class="list-group">
            <li class="list-group-item bg-secondary text-white" th:each="entry : ${sumaPorLugarConsumo}">
              <span th:text="${medioDescripcion[entry.key]}">Lugar de Consumo</span>:
              <span th:text="${entry.value}">0</span>
            </li>
          </ul>
        </div>
      </div>

      <!-- Tabla de reservas -->
      <h5 class="mt-4">Detalle de Reservas No Consumidas</h5>
      <table class="table table-dark table-striped">
        <thead>
        <tr>
          <th>Apellido</th>
          <th>Nombre</th>
          <th>Comida Principal</th>
          <th>Tipo Comida</th>
          <th>Lugar Consumo</th>
          <th>Acciones</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="reserva  : ${reservasNoConsumidas}">
          <td th:text="${reserva.usuario.apellido}"></td>
          <td th:text="${reserva.usuario.nombre}"></td>
          <td th:text="${reserva.menu.comida.principal}"></td>
          <td th:text="${tipoComidaDescripcion[reserva.menu.comida.tipo_comida]}"></td>
          <td th:text="${medioDescripcion[reserva.medio]}"></td>
          <td>
            <form th:action="@{/reservas/marcar-consumido/{id}(id=${reserva.idReserva})}" method="post">
              <button type="submit" class="btn btn-success">No entregado</button>
            </form>
          </td>
        </tr>
        </tbody>
      </table>

      <!-- Tabla de reservas consumidas -->
      <h5 class="mt-4">Reservas Consumidas</h5>
      <table class="table table-dark table-striped">
        <thead>
        <tr>
          <th>Apellido</th>
          <th>Nombre</th>
          <th>Comida Principal</th>
          <th>Tipo Comida</th>
          <th>Lugar Consumo</th>
          <th>Consumió</th>
          <th>Acciones</th>  <!-- Nueva columna para las acciones -->
        </tr>
        </thead>
        <tbody>
        <tr th:each="reserva : ${reservasConsumidas}">
          <td th:text="${reserva.usuario.apellido}"></td>
          <td th:text="${reserva.usuario.nombre}"></td>
          <td th:text="${reserva.menu.comida.principal}"></td>
          <td th:text="${tipoComidaDescripcion[reserva.menu.comida.tipo_comida]}"></td>
          <td th:text="${medioDescripcion[reserva.medio]}"></td>
          <td>
            Entregado:  <span th:text="${#temporals.format(reserva.entregado, 'dd-MM-yyyy HH:mm')}"></span>
          </td>
          <td>
            <form th:action="@{/reservas/cancelar-consumido/{id}(id=${reserva.idReserva})}" method="post">
              <button type="submit" class="btn btn-danger">
                Cancelar
              </button>
            </form>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<footer th:insert="fragments/footer :: footer" class="footer"></footer>
<script th:src="@{/bootstrap/js/bootstrap.min.js}"></script>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
</body>
</html>
